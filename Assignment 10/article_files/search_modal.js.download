(function ($) {
  $(document).ready(function () {

    var html = '<div id="search-close" style="display:none">X</div><div id="search_form" style="display:none"><input placeholder="Type your search here" type="text" id="search_input" size="30" maxlength="255" autofocus></div>';

    $('#menu-search').after(html);
    $('#menu-search').parent().css('position', 'relative');
    $('#menu-search').click(function () {
      $('#search_form').toggle();
      $('#search-close').toggle();
      $('#search_input').focus();
      return false;
    });
    
    $('#search-close').click(function () {
      $('#search_form').toggle();
      $('#search-close').toggle();
    });
    
    $('#search_form').click(function () {
      $('#search_form').toggle();
      $('#search-close').toggle();
    });
    $('#search_input').click(function () {
      return false;
    });

    $('#search_input').keypress(function (e) {
      if (e.which === 13) {
        var value = $(this).val();
        window.location.href = '/search/site/' + encodeURI(value);
      }
    });
  });
})(jQuery);
